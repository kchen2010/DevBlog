import{r,u as E,b as A,q as z,o as B,c as w,h as F,j as t,i as I,k as T,d as p,l as q,a as N,s as R}from"./index-CbJpiioY.js";import{M as W}from"./index-B7wBnopx.js";const L=()=>{const[d,x]=r.useState(""),[a,u]=r.useState(""),[y,g]=r.useState(""),[C,k]=r.useState([]),[s,f]=r.useState(null),[i,b]=r.useState(null),{user:m,loading:h}=E(),j=A();r.useEffect(()=>{!h&&!m&&j("/login")},[m,h,j]),r.useEffect(()=>{const e=z(w(p,"posts"),B("Date","desc"));return F(e,l=>{k(l.docs.map(v=>({id:v.id,...v.data()})))})},[]);const n=r.useCallback((e,o="success")=>{b({message:e,type:o}),setTimeout(()=>b(null),3e3)},[]),S=async e=>{e.preventDefault();const o=y.split(",").map(l=>l.trim()).filter(Boolean);try{s?(await q(T(p,"posts",s),{Title:d,Content:a,Tags:o}),n("Post updated successfully.")):(await N(w(p,"posts"),{Title:d,Content:a,Tags:o,Date:R()}),n("Post published.")),c()}catch(l){console.error("Error: ",l),n("Failed to save post.","error")}},P=async e=>{if(window.confirm("Are you sure you want to delete this post?"))try{await I(T(p,"posts",e)),s===e&&c(),n("Post deleted.")}catch(o){console.error("Error deleting:",o),n("Failed to delete post.","error")}},D=e=>{x(e.Title),u(e.Content),g(Array.isArray(e.Tags)?e.Tags.join(", "):e.Tags),f(e.id),window.scrollTo(0,0)},c=()=>{x(""),u(""),g(""),f(null)};return h?t.jsx("div",{style:{textAlign:"center",padding:"60px"},children:"Loading..."}):t.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px",display:"flex",gap:"30px"},children:[i&&t.jsx("div",{style:{position:"fixed",top:"80px",right:"20px",zIndex:200,padding:"12px 20px",borderRadius:"6px",background:i.type==="error"?"rgba(239, 68, 68, 0.15)":"rgba(74, 222, 128, 0.15)",border:`1px solid ${i.type==="error"?"#ef4444":"#4ade80"}`,color:i.type==="error"?"#ef4444":"#4ade80",fontSize:"0.9rem",animation:"fadeIn 0.2s ease"},children:i.message}),t.jsxs("div",{style:{width:"250px",flexShrink:0},children:[t.jsx("h3",{style:{color:"#94a3b8",borderBottom:"1px solid #334155",paddingBottom:"10px"},children:"Project_Files"}),t.jsx("button",{onClick:c,style:{width:"100%",marginBottom:"15px",border:"1px dashed #4ade80",color:"#4ade80"},children:"+ New File"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:C.map(e=>t.jsxs("div",{style:{padding:"10px",background:s===e.id?"rgba(34, 211, 238, 0.1)":"rgba(30, 41, 59, 0.5)",border:s===e.id?"1px solid #22d3ee":"1px solid rgba(255,255,255,0.05)",borderRadius:"4px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onClick:()=>D(e),children:[t.jsx("span",{style:{fontSize:"0.85rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"180px"},children:e.Title}),t.jsx("span",{onClick:o=>{o.stopPropagation(),P(e.id)},style:{color:"#ef4444",fontWeight:"bold",padding:"0 5px",cursor:"pointer"},title:"Delete",children:"Ã—"})]},e.id))})]}),t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{style:{marginTop:0},children:s?`Editing: ${d}`:"Create New Post"}),t.jsxs("form",{onSubmit:S,style:{display:"flex",flexDirection:"column",gap:"20px"},children:[t.jsx("input",{type:"text",placeholder:"Post Title",value:d,onChange:e=>x(e.target.value),required:!0,style:{padding:"10px",fontSize:"16px"}}),t.jsx("input",{type:"text",placeholder:"Tags (comma separated)",value:y,onChange:e=>g(e.target.value),style:{padding:"10px"}}),t.jsxs("div",{style:{display:"flex",gap:"20px",height:"500px"},children:[t.jsx("textarea",{placeholder:"Write your markdown here...",value:a,onChange:e=>u(e.target.value),style:{flex:1,padding:"15px",fontFamily:"'JetBrains Mono', monospace",resize:"none",fontSize:"0.9rem",lineHeight:"1.5"}}),t.jsx("div",{style:{flex:1,padding:"20px",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",overflowY:"auto",backgroundColor:"rgba(30, 41, 59, 0.5)",color:"#e2e8f0"},children:t.jsx("div",{className:"markdown-preview",style:{lineHeight:"1.6"},children:a?t.jsx(W,{children:a}):t.jsx("span",{style:{color:"#64748b"},children:"Preview..."})})})]}),t.jsxs("div",{style:{display:"flex",gap:"10px"},children:[t.jsx("button",{type:"submit",style:{flex:1,padding:"15px",backgroundColor:s?"#c084fc":"#007bff",color:"white",border:"none"},children:s?"Update Post":"Publish Post"}),s&&t.jsx("button",{type:"button",onClick:c,style:{flex:.2,backgroundColor:"#64748b",border:"none",color:"white"},children:"Cancel"})]})]})]})]})};export{L as default};
